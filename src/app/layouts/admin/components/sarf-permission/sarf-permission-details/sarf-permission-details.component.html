<div class=" m-2">
  <h1 class="inv-title  my-3">تفاصيل اذن الصرف</h1>

  <div id="print-section">
    <div class="my-3" fxLayout="row" fxLayoutAlign="space-between center">

      <span>التاريخ : {{permission.permissionDate }}</span>
      <span>العميل : {{permission.customer.name}}</span>

    </div>
    <button *ngIf="!permission.isApproved" mat-raised-button type="button" color="warn"
      (click)="openAddInvItemDialog()"> اضافة اصناف </button>




    <table mat-table [dataSource]="dataSource" class="mt-2 rounded-2 shadow-sm" style="direction: rtl;">

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> تسلسل </th>
        <td mat-cell *matCellDef="let orderItem"> {{orderItem.id}} </td>
      </ng-container>

      <ng-container matColumnDef="store">
        <th mat-header-cell *matHeaderCellDef> المخزن</th>
        <td mat-cell *matCellDef="let orderItem"> {{orderItem.store.name}} </td>
      </ng-container>

      <ng-container matColumnDef="unit">
        <th mat-header-cell *matHeaderCellDef> الوحدة</th>
        <td mat-cell *matCellDef="let orderItem"> {{orderItem.uom.name}} </td>
      </ng-container>

      <ng-container matColumnDef="orderItem">
        <th mat-header-cell *matHeaderCellDef> الصنف</th>
        <td mat-cell *matCellDef="let orderItem"> {{orderItem.item.name}} </td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef> الكمية </th>
        <td mat-cell *matCellDef="let orderItem"> {{orderItem.quantity}} </td>
      </ng-container>


      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let orderItem">


          <button *ngIf="!permission.isApproved" mat-icon-button (click)="deleteInvItem(orderItem)">
            <mat-icon color="danger">delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

  </div>
  <form (ngSubmit)="onSubmit()" [formGroup]="invoiceForm" class="invoice-form" fxLayout="column">

    <div fxLayout="row">
      <div class="w-100 mt-5 rounded-2">

        <div fxLayout="row-reverse" fxLayoutAlign="start center" >
          <mat-form-field fxFlex="100">
            <mat-label>ملاحظات</mat-label>
            <textarea matInput formControlName="notes" placeholder="ملاحظات"></textarea>
            <mat-error>
              <app-validation-msg [control]="invoiceForm.get('notes')" fieldName="ملاحظات"></app-validation-msg>
            </mat-error>
          </mat-form-field>

        </div>

        <div fxLayout="row-reverse" fxLayoutAlign="space-between center">
          <button *ngIf="!permission.isApproved" mat-raised-button color="primary" type="submit">حفظ و إعتماد
            الفاتورة</button>

          <button mat-raised-button color="primary" class="mx-2" [routerLink]="['/admin/print-sales', permission.id]">
            طباعة
            <mat-icon class="mx-2">cloud_download</mat-icon></button>
        </div>

      </div>
    </div>
  </form>


</div>
